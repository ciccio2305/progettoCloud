import{S as je,i as $e,s as we,H as Ke,h as Y,n as Ce,f as d,e as v,a as M,t as ne,c as p,b as g,g as N,d as ie,v as n,j as a,w as le,k as He,K as Zt,A as ue,B as fe,q as J,L as Pe,I as ze,r as Z,F as ct,x as Gt,m as Ve,o as Be,p as Me,u as Ne,z as rt,D as Bt,Z as ss,a7 as ls,l as ns,M as is,T as xt}from"../chunks/index.96ff6eb1.js";import{c as Ft}from"../chunks/config.a323d1f8.js";import"../chunks/singletons.7fe40cd3.js";import"../chunks/SideMenu.svelte_svelte_type_style_lang.3fadda24.js";import{b as Fe,d as et,e as Kt,f as Yt,g as at,h as pt,i as _t,j as ot,n as dt,T as Rt,k as bt,o as Xt,p as yt,s as as,q as os,u as Mt,v as cs,w as rs,r as Nt}from"../chunks/stores.32eab677.js";function ds(i){let t,l,e,s,o,u,C,c,r,f,m,S,h;return{c(){t=v("div"),l=v("div"),e=M(),s=v("div"),o=v("div"),u=ne(i[0]),C=M(),c=v("div"),r=v("div"),f=M(),m=v("div"),this.h()},l(_){t=p(_,"DIV",{class:!0});var V=g(t);l=p(V,"DIV",{class:!0,id:!0}),g(l).forEach(d),e=N(V),s=p(V,"DIV",{class:!0,id:!0});var P=g(s);o=p(P,"DIV",{class:!0});var B=g(o);u=ie(B,i[0]),B.forEach(d),C=N(P),c=p(P,"DIV",{id:!0,class:!0});var k=g(c);r=p(k,"DIV",{id:!0,class:!0}),g(r).forEach(d),f=N(k),m=p(k,"DIV",{id:!0,class:!0}),g(m).forEach(d),k.forEach(d),P.forEach(d),V.forEach(d),this.h()},h(){n(l,"class","ProfilePicture svelte-konfhz"),n(l,"id",i[1]),n(o,"class","name svelte-konfhz"),n(r,"id","message"),n(r,"class","svelte-konfhz"),n(m,"id","time"),n(m,"class","svelte-konfhz"),n(c,"id","messagePreview"),n(c,"class","svelte-konfhz"),n(s,"class","disable-select svelte-konfhz"),n(s,"id","text"),n(t,"class","ChatTabContainer svelte-konfhz")},m(_,V){Y(_,t,V),a(t,l),a(t,e),a(t,s),a(s,o),a(o,u),a(s,C),a(s,c),a(c,r),a(c,f),a(c,m),S||(h=le(t,"click",i[3]),S=!0)},p(_,V){V&2&&n(l,"id",_[1]),V&1&&He(u,_[0])},d(_){_&&d(t),S=!1,h()}}}function us(i){let t,l,e,s,o,u,C,c,r,f,m,S,h,_,V,P;return{c(){t=v("div"),l=v("div"),e=M(),s=v("div"),o=v("div"),u=ne(i[1]),C=M(),c=v("div"),r=ne(i[0]),f=M(),m=v("div"),S=v("div"),h=M(),_=v("div"),this.h()},l(B){t=p(B,"DIV",{class:!0});var k=g(t);l=p(k,"DIV",{class:!0,id:!0}),g(l).forEach(d),e=N(k),s=p(k,"DIV",{class:!0,id:!0});var $=g(s);o=p($,"DIV",{class:!0,style:!0});var y=g(o);u=ie(y,i[1]),y.forEach(d),C=N($),c=p($,"DIV",{class:!0});var I=g(c);r=ie(I,i[0]),I.forEach(d),f=N($),m=p($,"DIV",{id:!0,class:!0});var T=g(m);S=p(T,"DIV",{id:!0,class:!0}),g(S).forEach(d),h=N(T),_=p(T,"DIV",{id:!0,class:!0}),g(_).forEach(d),T.forEach(d),$.forEach(d),k.forEach(d),this.h()},h(){n(l,"class","ProfilePicture svelte-konfhz"),n(l,"id",i[1]),n(o,"class","topic"),Zt(o,"display","none"),n(c,"class","name svelte-konfhz"),n(S,"id","message"),n(S,"class","svelte-konfhz"),n(_,"id","time"),n(_,"class","svelte-konfhz"),n(m,"id","messagePreview"),n(m,"class","svelte-konfhz"),n(s,"class","disable-select svelte-konfhz"),n(s,"id","text"),n(t,"class","ChatTabContainer svelte-konfhz")},m(B,k){Y(B,t,k),a(t,l),a(t,e),a(t,s),a(s,o),a(o,u),a(s,C),a(s,c),a(c,r),a(s,f),a(s,m),a(m,S),a(m,h),a(m,_),V||(P=le(t,"click",i[4]),V=!0)},p(B,k){k&2&&n(l,"id",B[1]),k&2&&He(u,B[1]),k&1&&He(r,B[0])},d(B){B&&d(t),V=!1,P()}}}function fs(i){let t;function l(o,u){if(o[2]=="true")return us;if(o[2]=="false")return ds}let e=l(i),s=e&&e(i);return{c(){s&&s.c(),t=Ke()},l(o){s&&s.l(o),t=Ke()},m(o,u){s&&s.m(o,u),Y(o,t,u)},p(o,[u]){e===(e=l(o))&&s?s.p(o,u):(s&&s.d(1),s=e&&e(o),s&&(s.c(),s.m(t.parentNode,t)))},i:Ce,o:Ce,d(o){s&&s.d(o),o&&d(t)}}}function hs(i,t,l){let{name:e}=t,{topic:s}=t,{isSearch:o}=t,u;fetch(Ft.getHost()+"/api/getProfilePic",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topic:s.replace("usr","")})}).then(r=>r.json()).then(r=>{u=r;let f=document.getElementById(s);f.style.backgroundImage="url("+u.base39+")"});function C(){let r=document.getElementById("emptyPlace");r.style.display="none";let f=document.getElementById("internal");f.style.display="flex",Fe.set(""),Fe.set(e),et.set(s),Kt.set(u.base39)}function c(){Yt.set(s);let r=document.getElementById("emptyPlace");r.style.display="none";let f=document.getElementById("internal");f.style.display="flex",Fe.set(""),Fe.set(e),et.set(s)}return i.$$set=r=>{"name"in r&&l(0,e=r.name),"topic"in r&&l(1,s=r.topic),"isSearch"in r&&l(2,o=r.isSearch)},[e,s,o,C,c]}class gs extends je{constructor(t){super(),$e(this,t,hs,fs,we,{name:0,topic:1,isSearch:2})}}function ms(i){let t,l,e,s,o,u,C;return{c(){t=v("div"),l=v("div"),e=M(),s=v("div"),o=ne(i[0]),this.h()},l(c){t=p(c,"DIV",{class:!0});var r=g(t);l=p(r,"DIV",{id:!0});var f=g(l);f.forEach(d),e=N(r),s=p(r,"DIV",{class:!0});var m=g(s);o=ie(m,i[0]),m.forEach(d),r.forEach(d),this.h()},h(){n(l,"id","propic"),n(s,"class","name svelte-486iq3"),n(t,"class","newChatsContainer svelte-486iq3")},m(c,r){Y(c,t,r),a(t,l),a(t,e),a(t,s),a(s,o),u||(C=le(t,"click",i[1]),u=!0)},p(c,[r]){r&1&&He(o,c[0])},i:Ce,o:Ce,d(c){c&&d(t),u=!1,C()}}}function vs(i,t,l){let{name:e}=t,{topic:s}=t;function o(){let u=document.getElementById("internal");u.style.display="flex";let C=document.getElementById("emptyPlace");C.style.display="none";let c=document.getElementById("newChatTab"),r=document.getElementById("newChatTabBackdrop");c.style.display="none",r.style.display="none",et.set(s),location.reload()}return i.$$set=u=>{"name"in u&&l(0,e=u.name),"topic"in u&&l(2,s=u.topic)},[e,o,s]}class ps extends je{constructor(t){super(),$e(this,t,vs,ms,we,{name:0,topic:2})}}function jt(i,t,l){const e=i.slice();return e[5]=t[l],e}function $t(i,t,l){const e=i.slice();return e[8]=t[l],e}function Lt(i){let t,l;return t=new gs({props:{name:i[8].name,topic:i[8].topic,isSearch:i[8].isSearch}}),{c(){Ve(t.$$.fragment)},l(e){Be(t.$$.fragment,e)},m(e,s){Me(t,e,s),l=!0},p(e,s){const o={};s&1&&(o.name=e[8].name),s&1&&(o.topic=e[8].topic),s&1&&(o.isSearch=e[8].isSearch),t.$set(o)},i(e){l||(J(t.$$.fragment,e),l=!0)},o(e){Z(t.$$.fragment,e),l=!1},d(e){Ne(t,e)}}}function Ot(i){let t,l;return t=new ps({props:{name:i[5].name,topic:i[5].topic}}),{c(){Ve(t.$$.fragment)},l(e){Be(t.$$.fragment,e)},m(e,s){Me(t,e,s),l=!0},p(e,s){const o={};s&2&&(o.name=e[5].name),s&2&&(o.topic=e[5].topic),t.$set(o)},i(e){l||(J(t.$$.fragment,e),l=!0)},o(e){Z(t.$$.fragment,e),l=!1},d(e){Ne(t,e)}}}function _s(i){let t,l,e,s,o,u,C,c,r,f,m,S,h,_,V,P,B,k,$,y,I,T,H,U,R,G,ae,ve,oe,W,Ee,he,be,ce,F,Q,ee,K=i[0],z=[];for(let b=0;b<K.length;b+=1)z[b]=Lt($t(i,K,b));const ge=b=>Z(z[b],1,1,()=>{z[b]=null});let me=i[1],O=[];for(let b=0;b<me.length;b+=1)O[b]=Ot(jt(i,me,b));const Ye=b=>Z(O[b],1,1,()=>{O[b]=null});return{c(){t=v("div"),l=v("div"),e=v("div"),s=v("div"),o=ne("Chats"),u=M(),C=v("div"),c=ue("svg"),r=ue("path"),f=M(),m=v("input"),S=M(),h=v("div"),_=M(),V=v("div");for(let b=0;b<z.length;b+=1)z[b].c();P=M(),B=v("div"),k=M(),$=v("div"),y=v("div"),I=ue("svg"),T=ue("path"),H=M(),U=v("div"),R=v("div"),G=v("div"),ae=ne("Inserisci il nome dell'utente con cui vorresti chattare"),ve=M(),oe=v("div"),W=v("input"),Ee=M(),he=v("div"),be=M(),ce=v("div");for(let b=0;b<O.length;b+=1)O[b].c();this.h()},l(b){t=p(b,"DIV",{id:!0,class:!0});var D=g(t);l=p(D,"DIV",{id:!0,class:!0});var w=g(l);e=p(w,"DIV",{id:!0,class:!0});var te=g(e);s=p(te,"DIV",{class:!0});var se=g(s);o=ie(se,"Chats"),se.forEach(d),u=N(te),C=p(te,"DIV",{id:!0,class:!0});var ye=g(C);c=fe(ye,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,class:!0});var Je=g(c);r=fe(Je,"path",{d:!0,class:!0}),g(r).forEach(d),Je.forEach(d),ye.forEach(d),te.forEach(d),f=N(w),m=p(w,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),w.forEach(d),S=N(D),h=p(D,"DIV",{class:!0}),g(h).forEach(d),_=N(D),V=p(D,"DIV",{id:!0,class:!0});var X=g(V);for(let L=0;L<z.length;L+=1)z[L].l(X);X.forEach(d),D.forEach(d),P=N(b),B=p(b,"DIV",{id:!0,class:!0});var Re=g(B);Re.forEach(d),k=N(b),$=p(b,"DIV",{id:!0,class:!0});var x=g($);y=p(x,"DIV",{id:!0,class:!0});var re=g(y);I=fe(re,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,class:!0});var Ie=g(I);T=fe(Ie,"path",{d:!0,class:!0}),g(T).forEach(d),Ie.forEach(d),re.forEach(d),H=N(x),U=p(x,"DIV",{id:!0,class:!0});var pe=g(U);R=p(pe,"DIV",{id:!0,class:!0});var ke=g(R);G=p(ke,"DIV",{class:!0});var Ae=g(G);ae=ie(Ae,"Inserisci il nome dell'utente con cui vorresti chattare"),Ae.forEach(d),ke.forEach(d),ve=N(pe),oe=p(pe,"DIV",{id:!0,class:!0});var Xe=g(oe);W=p(Xe,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),Xe.forEach(d),pe.forEach(d),Ee=N(x),he=p(x,"DIV",{id:!0,class:!0}),g(he).forEach(d),be=N(x),ce=p(x,"DIV",{id:!0,class:!0});var _e=g(ce);for(let L=0;L<O.length;L+=1)O[L].l(_e);_e.forEach(d),x.forEach(d),this.h()},h(){n(s,"class","title svelte-e4aqsw"),n(r,"d","M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"),n(r,"class","svelte-e4aqsw"),n(c,"xmlns","http://www.w3.org/2000/svg"),n(c,"width","100%"),n(c,"height","100%"),n(c,"viewBox"," 0 0 24 24"),n(c,"class","svelte-e4aqsw"),n(C,"id","addChatsIcon"),n(C,"class","svelte-e4aqsw"),n(e,"id","topOrganizer"),n(e,"class","svelte-e4aqsw"),n(m,"type","text"),n(m,"id","search"),n(m,"placeholder","Cerca..."),n(m,"class","svelte-e4aqsw"),n(l,"id","TopSectionChatsContainer"),n(l,"class","svelte-e4aqsw"),n(h,"class","svelte-e4aqsw"),n(V,"id","ChatsList"),n(V,"class","svelte-e4aqsw"),n(t,"id","ChatsContainer"),n(t,"class","svelte-e4aqsw"),n(B,"id","newChatTabBackdrop"),n(B,"class","svelte-e4aqsw"),n(T,"d","M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"),n(T,"class","svelte-e4aqsw"),n(I,"xmlns","http://www.w3.org/2000/svg"),n(I,"width","100%"),n(I,"height","100%"),n(I,"viewBox"," 0 0 24 24"),n(I,"class","svelte-e4aqsw"),n(y,"id","close"),n(y,"class","svelte-e4aqsw"),n(G,"class","svelte-e4aqsw"),n(R,"id","text"),n(R,"class","svelte-e4aqsw"),n(W,"type","text"),n(W,"id","search"),n(W,"placeholder","Cerca..."),n(W,"class","svelte-e4aqsw"),n(oe,"id","searchBar"),n(oe,"class","svelte-e4aqsw"),n(U,"id","top"),n(U,"class","svelte-e4aqsw"),n(he,"id","separator"),n(he,"class","svelte-e4aqsw"),n(ce,"id","middle"),n(ce,"class","svelte-e4aqsw"),n($,"id","newChatTab"),n($,"class","svelte-e4aqsw")},m(b,D){Y(b,t,D),a(t,l),a(l,e),a(e,s),a(s,o),a(e,u),a(e,C),a(C,c),a(c,r),a(l,f),a(l,m),a(t,S),a(t,h),a(t,_),a(t,V);for(let w=0;w<z.length;w+=1)z[w]&&z[w].m(V,null);Y(b,P,D),Y(b,B,D),Y(b,k,D),Y(b,$,D),a($,y),a(y,I),a(I,T),a($,H),a($,U),a(U,R),a(R,G),a(G,ae),a(U,ve),a(U,oe),a(oe,W),a($,Ee),a($,he),a($,be),a($,ce);for(let w=0;w<O.length;w+=1)O[w]&&O[w].m(ce,null);F=!0,Q||(ee=[le(C,"click",i[2]),le(m,"keyup",bs),le(y,"click",Cs),le(W,"keyup",ys)],Q=!0)},p(b,[D]){if(D&1){K=b[0];let w;for(w=0;w<K.length;w+=1){const te=$t(b,K,w);z[w]?(z[w].p(te,D),J(z[w],1)):(z[w]=Lt(te),z[w].c(),J(z[w],1),z[w].m(V,null))}for(Pe(),w=K.length;w<z.length;w+=1)ge(w);ze()}if(D&2){me=b[1];let w;for(w=0;w<me.length;w+=1){const te=jt(b,me,w);O[w]?(O[w].p(te,D),J(O[w],1)):(O[w]=Ot(te),O[w].c(),J(O[w],1),O[w].m(ce,null))}for(Pe(),w=me.length;w<O.length;w+=1)Ye(w);ze()}},i(b){if(!F){for(let D=0;D<K.length;D+=1)J(z[D]);for(let D=0;D<me.length;D+=1)J(O[D]);F=!0}},o(b){z=z.filter(Boolean);for(let D=0;D<z.length;D+=1)Z(z[D]);O=O.filter(Boolean);for(let D=0;D<O.length;D+=1)Z(O[D]);F=!1},d(b){b&&d(t),ct(z,b),b&&d(P),b&&d(B),b&&d(k),b&&d($),ct(O,b),Q=!1,Gt(ee)}}}function bs(i){if(i.target.value.length>=1){console.log(i.target.value);let t=i.target.value,e=document.getElementById("ChatsList").children;for(let s=0;s<e.length;s++)e[s].getElementsByClassName("name")[0].innerHTML.includes(t)?e[s].style.display="flex":e[s].style.display="none"}else if(i.target.value.length==0){let l=document.getElementById("ChatsList").children;for(let e=0;e<l.length;e++)l[e].style.display="flex"}}function ys(i){if(i.target.value.length>=1){console.log(i.target.value);let t=i.target.value,e=document.getElementById("middle").children;for(let s=0;s<e.length;s++)e[s].getElementsByClassName("name")[0].innerHTML.includes(t)?e[s].style.display="flex":e[s].style.display="none"}else if(i.target.value.length==0){let l=document.getElementById("middle").children;for(let e=0;e<l.length;e++)l[e].style.display="flex"}}function Cs(){let i=document.getElementById("newChatTab"),t=document.getElementById("newChatTabBackdrop");i.style.display="none",t.style.display="none"}function ws(i,t,l){var e=[],s=[];let o="",u="";at.subscribe(c=>{console.log(c),l(0,e=[...c])});function C(){let c=document.getElementById("newChatTab"),r=document.getElementById("newChatTabBackdrop");c.style.display="flex",r.style.display="block",fetch(Ft.getHost()+"/api/tinode/find_user/all",{method:"GET",headers:{"Content-Type":"application/json"}}).then(f=>f.json()).then(f=>{l(1,s=[...f]),console.log(f)})}return pt.subscribe(c=>{c.includes("data:image")?o="Foto":o=c}),_t.subscribe(c=>{u=c}),ot.subscribe(c=>{let r=document.getElementsByClassName("name");for(let f=0;f<r.length;f++)console.log(r[f].innerHTML),console.log(c),r[f].innerHTML==c&&(console.log("parent"),setTimeout(()=>{r[f].parentElement.children[1].children[0].innerHTML=o,r[f].parentElement.children[1].children[1].innerHTML=u},1e3))}),[e,s,C]}class Es extends je{constructor(t){super(),$e(this,t,ws,_s,we,{})}}function Is(i){let t,l;return{c(){t=v("div"),l=ne(i[0]),this.h()},l(e){t=p(e,"DIV",{id:!0,class:!0});var s=g(t);l=ie(s,i[0]),s.forEach(d),this.h()},h(){n(t,"id","text"),n(t,"class","svelte-iga2yy")},m(e,s){Y(e,t,s),a(t,l)},p(e,s){s&1&&He(l,e[0])},d(e){e&&d(t)}}}function ks(i){let t,l;return{c(){t=v("img"),this.h()},l(e){t=p(e,"IMG",{src:!0,class:!0}),this.h()},h(){rt(t.src,l=i[0])||n(t,"src",l),n(t,"class","svelte-iga2yy")},m(e,s){Y(e,t,s)},p(e,s){s&1&&!rt(t.src,l=e[0])&&n(t,"src",l)},d(e){e&&d(t)}}}function Ss(i){let t,l,e,s,o,u,C;function c(m,S){return S&1&&(e=null),e==null&&(e=!!m[0].includes("base64,")),e?ks:Is}let r=c(i,-1),f=r(i);return{c(){t=v("div"),l=v("div"),f.c(),s=M(),o=v("div"),u=ne(i[1]),this.h()},l(m){t=p(m,"DIV",{class:!0});var S=g(t);l=p(S,"DIV",{class:!0});var h=g(l);f.l(h),s=N(h),o=p(h,"DIV",{class:!0,id:!0});var _=g(o);u=ie(_,i[1]),_.forEach(d),h.forEach(d),S.forEach(d),this.h()},h(){n(o,"class","disable-select svelte-iga2yy"),n(o,"id","time"),n(l,"class",C=i[2]==="sender"?"senderBubble":"recipientBubble"),n(t,"class","message svelte-iga2yy")},m(m,S){Y(m,t,S),a(t,l),f.m(l,null),a(l,s),a(l,o),a(o,u)},p(m,[S]){r===(r=c(m,S))&&f?f.p(m,S):(f.d(1),f=r(m),f&&(f.c(),f.m(l,s))),S&2&&He(u,m[1]),S&4&&C!==(C=m[2]==="sender"?"senderBubble":"recipientBubble")&&n(l,"class",C)},i:Ce,o:Ce,d(m){m&&d(t),f.d()}}}function Ds(i,t,l){let{text:e}=t,{time:s}=t,{user:o=""}=t;return i.$$set=u=>{"text"in u&&l(0,e=u.text),"time"in u&&l(1,s=u.time),"user"in u&&l(2,o=u.user)},[e,s,o]}class Qt extends je{constructor(t){super(),$e(this,t,Ds,Ss,we,{text:0,time:1,user:2})}}const Ts=""+new URL("../assets/no-comment.e2649e83.png",import.meta.url).href;function qt(i,t,l){const e=i.slice();return e[20]=t[l],e}function Ht(i,t,l){const e=i.slice();return e[23]=t[l],e}function Pt(i){let t,l;return t=new Qt({props:{text:i[23].content,time:i[23].ts,user:i[23].from}}),{c(){Ve(t.$$.fragment)},l(e){Be(t.$$.fragment,e)},m(e,s){Me(t,e,s),l=!0},p(e,s){const o={};s&8&&(o.text=e[23].content),s&8&&(o.time=e[23].ts),s&8&&(o.user=e[23].from),t.$set(o)},i(e){l||(J(t.$$.fragment,e),l=!0)},o(e){Z(t.$$.fragment,e),l=!1},d(e){Ne(t,e)}}}function zt(i){let t,l,e=i[23].content!="Null"&&Pt(i);return{c(){e&&e.c(),t=Ke()},l(s){e&&e.l(s),t=Ke()},m(s,o){e&&e.m(s,o),Y(s,t,o),l=!0},p(s,o){s[23].content!="Null"?e?(e.p(s,o),o&8&&J(e,1)):(e=Pt(s),e.c(),J(e,1),e.m(t.parentNode,t)):e&&(Pe(),Z(e,1,1,()=>{e=null}),ze())},i(s){l||(J(e),l=!0)},o(s){Z(e),l=!1},d(s){e&&e.d(s),s&&d(t)}}}function Jt(i){let t,l;return t=new Qt({props:{text:i[20].content,time:i[20].ts,user:i[20].from}}),{c(){Ve(t.$$.fragment)},l(e){Be(t.$$.fragment,e)},m(e,s){Me(t,e,s),l=!0},p(e,s){const o={};s&16&&(o.text=e[20].content),s&16&&(o.time=e[20].ts),s&16&&(o.user=e[20].from),t.$set(o)},i(e){l||(J(t.$$.fragment,e),l=!0)},o(e){Z(t.$$.fragment,e),l=!1},d(e){Ne(t,e)}}}function At(i){let t,l,e=i[20].content!="Null"&&Jt(i);return{c(){e&&e.c(),t=Ke()},l(s){e&&e.l(s),t=Ke()},m(s,o){e&&e.m(s,o),Y(s,t,o),l=!0},p(s,o){s[20].content!="Null"?e?(e.p(s,o),o&16&&J(e,1)):(e=Jt(s),e.c(),J(e,1),e.m(t.parentNode,t)):e&&(Pe(),Z(e,1,1,()=>{e=null}),ze())},i(s){l||(J(e),l=!0)},o(s){Z(e),l=!1},d(s){e&&e.d(s),s&&d(t)}}}function Vs(i){let t,l,e,s,o,u,C,c,r,f,m,S,h,_,V,P,B,k,$,y,I,T,H,U,R,G,ae,ve,oe,W,Ee,he,be,ce,F,Q,ee,K,z,ge,me,O,Ye,b,D,w,te,se,ye,Je,X,Re,x,re,Ie,pe,ke,Ae,Xe,_e=i[3],L=[];for(let j=0;j<_e.length;j+=1)L[j]=zt(Ht(i,_e,j));const es=j=>Z(L[j],1,1,()=>{L[j]=null});let Le=i[4],A=[];for(let j=0;j<Le.length;j+=1)A[j]=At(qt(i,Le,j));const ts=j=>Z(A[j],1,1,()=>{A[j]=null});return{c(){t=v("div"),l=v("div"),e=v("img"),o=M(),u=v("div"),C=ue("svg"),c=ue("path"),r=ue("path"),f=M(),m=v("div"),S=v("img"),_=M(),V=v("h3"),P=ne("Sembra che non ci sia nessuna chat aperta qui!"),B=M(),k=v("div"),$=v("div"),y=v("div"),I=v("div"),T=M(),H=v("div"),U=ne(i[0]),R=M(),G=v("div"),ae=v("div"),ve=ne(Ut),oe=M(),W=v("div");for(let j=0;j<L.length;j+=1)L[j].c();Ee=M();for(let j=0;j<A.length;j+=1)A[j].c();he=M(),be=v("div"),ce=M(),F=v("div"),Q=v("div"),ee=v("div"),K=v("div"),z=ne(`Immagine\r
                        `),ge=v("input"),me=M(),O=v("div"),Ye=ne("Documento"),b=M(),D=v("div"),w=ne("Video"),te=M(),se=ue("svg"),ye=ue("path"),Je=M(),X=v("input"),Re=M(),x=v("div"),re=ue("svg"),Ie=ue("path"),pe=ue("path"),this.h()},l(j){t=p(j,"DIV",{id:!0,class:!0});var q=g(t);l=p(q,"DIV",{id:!0,class:!0});var E=g(l);e=p(E,"IMG",{id:!0,src:!0,alt:!0,class:!0}),o=N(E),u=p(E,"DIV",{id:!0,class:!0});var Se=g(u);C=fe(Se,"svg",{viewBox:!0,xmlns:!0});var ut=g(C);c=fe(ut,"path",{d:!0}),g(c).forEach(d),r=fe(ut,"path",{d:!0}),g(r).forEach(d),ut.forEach(d),Se.forEach(d),E.forEach(d),f=N(q),m=p(q,"DIV",{id:!0,class:!0});var tt=g(m);S=p(tt,"IMG",{id:!0,src:!0,alt:!0,class:!0}),_=N(tt),V=p(tt,"H3",{class:!0});var Ct=g(V);P=ie(Ct,"Sembra che non ci sia nessuna chat aperta qui!"),Ct.forEach(d),tt.forEach(d),B=N(q),k=p(q,"DIV",{id:!0,class:!0});var De=g(k);$=p(De,"DIV",{id:!0,class:!0});var wt=g($);y=p(wt,"DIV",{id:!0,class:!0});var st=g(y);I=p(st,"DIV",{id:!0,class:!0}),g(I).forEach(d),T=N(st),H=p(st,"DIV",{id:!0,class:!0});var Et=g(H);U=ie(Et,i[0]),Et.forEach(d),st.forEach(d),wt.forEach(d),R=N(De),G=p(De,"DIV",{class:!0});var It=g(G);ae=p(It,"DIV",{class:!0});var kt=g(ae);ve=ie(kt,Ut),kt.forEach(d),It.forEach(d),oe=N(De),W=p(De,"DIV",{id:!0,class:!0});var Ue=g(W);for(let Oe=0;Oe<L.length;Oe+=1)L[Oe].l(Ue);Ee=N(Ue);for(let Oe=0;Oe<A.length;Oe+=1)A[Oe].l(Ue);he=N(Ue),be=p(Ue,"DIV",{id:!0}),g(be).forEach(d),Ue.forEach(d),ce=N(De),F=p(De,"DIV",{id:!0,class:!0});var We=g(F);Q=p(We,"DIV",{id:!0,class:!0});var lt=g(Q);ee=p(lt,"DIV",{id:!0,class:!0});var Ze=g(ee);K=p(Ze,"DIV",{class:!0});var ft=g(K);z=ie(ft,`Immagine\r
                        `),ge=p(ft,"INPUT",{style:!0,type:!0,accept:!0,class:!0}),ft.forEach(d),me=N(Ze),O=p(Ze,"DIV",{class:!0});var St=g(O);Ye=ie(St,"Documento"),St.forEach(d),b=N(Ze),D=p(Ze,"DIV",{class:!0});var Dt=g(D);w=ie(Dt,"Video"),Dt.forEach(d),Ze.forEach(d),te=N(lt),se=fe(lt,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0,class:!0});var Tt=g(se);ye=fe(Tt,"path",{d:!0,fill:!0}),g(ye).forEach(d),Tt.forEach(d),lt.forEach(d),Je=N(We),X=p(We,"INPUT",{type:!0,placeholder:!0,name:!0,class:!0}),Re=N(We),x=p(We,"DIV",{id:!0,class:!0});var Vt=g(x);re=fe(Vt,"svg",{viewBox:!0,xmlns:!0,class:!0});var ht=g(re);Ie=fe(ht,"path",{d:!0}),g(Ie).forEach(d),pe=fe(ht,"path",{d:!0}),g(pe).forEach(d),ht.forEach(d),Vt.forEach(d),We.forEach(d),De.forEach(d),q.forEach(d),this.h()},h(){n(e,"id","imagePreview"),rt(e.src,s="")||n(e,"src",s),n(e,"alt","toSend"),n(e,"class","svelte-5c6j3b"),n(c,"d","M291.48,449.94A15,15,0,0,1,278,441.5L207.5,296.57,62.57,226.08a15,15,0,0,1,1-27.41L435.48,49.08A15,15,0,0,1,455,68.6L305.4,440.54A15,15,0,0,1,292,449.93Zm-185.38-236,119.18,58a15,15,0,0,1,6.93,6.93l58,119.18L414,90Z"),n(r,"d","M218.72,300.35a15,15,0,0,1-10.6-25.61L430.47,52.39a15,15,0,1,1,21.21,21.22L229.33,296A15,15,0,0,1,218.72,300.35Z"),n(C,"viewBox","0 0 512 512"),n(C,"xmlns","http://www.w3.org/2000/svg"),n(u,"id","imgSend"),n(u,"class","svelte-5c6j3b"),n(l,"id","imgSender"),n(l,"class","svelte-5c6j3b"),n(S,"id","empty"),rt(S.src,h=Ts)||n(S,"src",h),n(S,"alt","empty"),n(S,"class","svelte-5c6j3b"),n(V,"class","svelte-5c6j3b"),n(m,"id","emptyPlace"),n(m,"class","svelte-5c6j3b"),n(I,"id","proPic"),n(I,"class","svelte-5c6j3b"),n(H,"id","name"),n(H,"class","svelte-5c6j3b"),n(y,"id","ProPicAndName"),n(y,"class","svelte-5c6j3b"),n($,"id","TopSection"),n($,"class","svelte-5c6j3b"),n(ae,"class","date svelte-5c6j3b"),n(G,"class","interspace svelte-5c6j3b"),n(be,"id","anchor"),n(W,"id","ChatContent"),n(W,"class","svelte-5c6j3b"),Zt(ge,"display","none"),n(ge,"type","file"),n(ge,"accept",".jpg, .jpeg, .png"),n(ge,"class","svelte-5c6j3b"),n(K,"class","svelte-5c6j3b"),n(O,"class","svelte-5c6j3b"),n(D,"class","svelte-5c6j3b"),n(ee,"id","allegatiDiv"),n(ee,"class","svelte-5c6j3b"),n(ye,"d","M17.004 5H9C7.162 5 5.414 5.737 4.076 7.076C2.737 8.415 2 10.163 2 12C2 13.838 2.737 15.586 4.076 16.924C5.414 18.263 7.162 19 9 19H17V17H9C7.697 17 6.45 16.471 5.49 15.51C4.529 14.55 4 13.303 4 12C4 10.698 4.529 9.451 5.49 8.49C6.45 7.529 7.697 7 9 7H17H17.004C17.794 7 18.543 7.314 19.113 7.886C19.684 8.457 19.999 9.208 20 10.002C19.9997 10.3947 19.9214 10.7835 19.7696 11.1457C19.6179 11.5079 19.3957 11.8363 19.116 12.112C18.8392 12.3922 18.5098 12.6148 18.1466 12.7672C17.7835 12.9196 17.3938 12.9987 17 13H9C8.86963 12.9984 8.74086 12.9711 8.62108 12.9196C8.50129 12.8681 8.39286 12.7935 8.302 12.7C8.20794 12.609 8.13283 12.5003 8.08099 12.3802C8.02916 12.2601 8.00163 12.1308 8 12C8 11.748 8.11 11.493 8.301 11.302C8.39171 11.2079 8.50021 11.1327 8.6202 11.0809C8.7402 11.029 8.86929 11.0015 9 11H17V9H9C8.21 9 7.459 9.315 6.886 9.889C6.314 10.461 6 11.211 6 12C6 12.789 6.314 13.54 6.888 14.114C7.16401 14.3939 7.49277 14.6164 7.85529 14.7685C8.21781 14.9205 8.60688 14.9992 9 15H17.001C17.6572 14.9995 18.3068 14.8691 18.9123 14.6163C19.5178 14.3635 20.0673 13.9933 20.529 13.527C20.9948 13.0652 21.3644 12.5156 21.6167 11.9101C21.8689 11.3047 21.9988 10.6552 21.9987 9.99929C21.9986 9.34337 21.8686 8.69395 21.6161 8.08854C21.3637 7.48313 20.9939 6.93371 20.528 6.472C20.0674 6.0055 19.5186 5.63515 18.9137 5.38246C18.3087 5.12977 17.6596 4.99976 17.004 5Z"),n(ye,"fill","black"),n(se,"width","100%"),n(se,"height","100%"),n(se,"viewBox","0 0 24 24"),n(se,"fill","none"),n(se,"xmlns","http://www.w3.org/2000/svg"),n(se,"class","svelte-5c6j3b"),n(Q,"id","allegati"),n(Q,"class","svelte-5c6j3b"),n(X,"type","text"),n(X,"placeholder","Scrivi qui..."),n(X,"name","input"),n(X,"class","svelte-5c6j3b"),n(Ie,"d","M291.48,449.94A15,15,0,0,1,278,441.5L207.5,296.57,62.57,226.08a15,15,0,0,1,1-27.41L435.48,49.08A15,15,0,0,1,455,68.6L305.4,440.54A15,15,0,0,1,292,449.93Zm-185.38-236,119.18,58a15,15,0,0,1,6.93,6.93l58,119.18L414,90Z"),n(pe,"d","M218.72,300.35a15,15,0,0,1-10.6-25.61L430.47,52.39a15,15,0,1,1,21.21,21.22L229.33,296A15,15,0,0,1,218.72,300.35Z"),n(re,"viewBox","0 0 512 512"),n(re,"xmlns","http://www.w3.org/2000/svg"),n(re,"class","svelte-5c6j3b"),n(x,"id","send"),n(x,"class","svelte-5c6j3b"),n(F,"id","ChatInput"),n(F,"class","svelte-5c6j3b"),n(k,"id","internal"),n(k,"class","svelte-5c6j3b"),n(t,"id","ChatContainer"),n(t,"class","svelte-5c6j3b")},m(j,q){Y(j,t,q),a(t,l),a(l,e),a(l,o),a(l,u),a(u,C),a(C,c),a(C,r),a(t,f),a(t,m),a(m,S),a(m,_),a(m,V),a(V,P),a(t,B),a(t,k),a(k,$),a($,y),a(y,I),a(y,T),a(y,H),a(H,U),a(k,R),a(k,G),a(G,ae),a(ae,ve),a(k,oe),a(k,W);for(let E=0;E<L.length;E+=1)L[E]&&L[E].m(W,null);a(W,Ee);for(let E=0;E<A.length;E+=1)A[E]&&A[E].m(W,null);a(W,he),a(W,be),a(k,ce),a(k,F),a(F,Q),a(Q,ee),a(ee,K),a(K,z),a(K,ge),i[9](ge),a(ee,me),a(ee,O),a(O,Ye),a(ee,b),a(ee,D),a(D,w),a(Q,te),a(Q,se),a(se,ye),a(F,Je),a(F,X),Bt(X,i[1]),a(F,Re),a(F,x),a(x,re),a(re,Ie),a(re,pe),ke=!0,Ae||(Xe=[le(u,"click",i[7]),le(ge,"change",i[8]),le(K,"click",function(){ss(i[2].click())&&i[2].click().apply(this,arguments)}),le(Q,"click",i[10]),le(X,"keyup",ls(i[5])),le(X,"input",i[11]),le(x,"click",i[12])],Ae=!0)},p(j,[q]){if(i=j,(!ke||q&1)&&He(U,i[0]),q&8){_e=i[3];let E;for(E=0;E<_e.length;E+=1){const Se=Ht(i,_e,E);L[E]?(L[E].p(Se,q),J(L[E],1)):(L[E]=zt(Se),L[E].c(),J(L[E],1),L[E].m(W,Ee))}for(Pe(),E=_e.length;E<L.length;E+=1)es(E);ze()}if(q&16){Le=i[4];let E;for(E=0;E<Le.length;E+=1){const Se=qt(i,Le,E);A[E]?(A[E].p(Se,q),J(A[E],1)):(A[E]=At(Se),A[E].c(),J(A[E],1),A[E].m(W,he))}for(Pe(),E=Le.length;E<A.length;E+=1)ts(E);ze()}q&2&&X.value!==i[1]&&Bt(X,i[1])},i(j){if(!ke){for(let q=0;q<_e.length;q+=1)J(L[q]);for(let q=0;q<Le.length;q+=1)J(A[q]);ke=!0}},o(j){L=L.filter(Boolean);for(let q=0;q<L.length;q+=1)Z(L[q]);A=A.filter(Boolean);for(let q=0;q<A.length;q+=1)Z(A[q]);ke=!1},d(j){j&&d(t),ct(L,j),ct(A,j),i[9](null),Ae=!1,Gt(Xe)}}}let Ut="";function Bs(i){let t=document.getElementById("allegatiDiv");console.log("allegati: "+t.style.display),getComputedStyle(t).display=="none"?t.style.display="flex":t.style.display="none"}function Ms(i,t,l){let e;ns(i,dt,y=>l(17,e=y));let s=["Do","Lu","Ma","Me","Gi","Ve","Sa"],o="",u="",C,c,r={content:"Null",ts:"Null",from:"Null"},f=[],m=[r];Kt.subscribe(y=>{let I=document.getElementById("proPic");(I!=null||I!=null)&&(I.style.backgroundImage="url("+y+")")}),Rt.subscribe(y=>{}),Fe.subscribe(y=>{console.log(y),l(0,o=y)}),dt.subscribe(y=>{console.log(y);let I=e;if(I.length>0){console.log(I[0]),l(4,m=[...m,I[0]]);let T=document.getElementById("ChatContent");T&&setTimeout(()=>{T.scrollTop=T.scrollHeight},1)}}),bt.subscribe(y=>{l(3,f=[]),l(4,m=[]),console.log(y),console.log("Messages del cazzo");let I=document.getElementById("ChatContent");I&&setTimeout(()=>{I.scrollTop=I.scrollHeight},1);for(let T=y.length-1;T>=0;T--)f.push(y[T]);console.log("Messaggi: "),console.log(f),l(3,f=[...f]),f.length>0&&(ot.set(o),pt.set(f[f.length-1].content),_t.set(f[f.length-1].ts))});function S(y){if(u!=""){if(y=="send"){let I={to:o,content:u};console.log(I),yt.set(I);let T=new Date;r={content:I.content,ts:T.getHours()+":"+((T.getMinutes()<10?"0":"")+T.getMinutes()),from:"sender",dayWeek:s[T.getDay()]},l(4,m=[...m,r]),l(1,u="");let H=document.getElementById("ChatContent");H&&setTimeout(()=>{H.scrollTop=H.scrollHeight},1),console.log(m)}else if(y.preventDefault(),y.stopPropagation(),y.keyCode===13){let I={to:o,content:u};console.log(I),yt.set(I);let T=new Date;r={content:I.content,ts:T.getHours()+":"+((T.getMinutes()<10?"0":"")+T.getMinutes()),from:"sender",dayWeek:s[T.getDay()]},l(4,m=[...m,r]),ot.set(" "),ot.set(o),console.log("lastMsgUser: "+o),pt.set(r.content),_t.set(r.ts),l(1,u="");let H=document.getElementById("ChatContent");H&&setTimeout(()=>{H.scrollTop=H.scrollHeight},1),console.log(m)}}}const h=y=>{console.log("fileSelect"),y.stopPropagation(),y.preventDefault();var I=y.target.files[0];let T=new FileReader;T.readAsDataURL(I),T.onload=H=>{var ae;console.log(H.target.result);let U=H.target.result,R=U.split(";")[0];R=R.split(":")[1],U=U.split(",")[1];let G={name:(ae=H.target)==null?void 0:ae.result.name,content:U,type:R,size:H.total};if(console.log("tosend: "),console.log(G),G.size>2e5)alert("il file supera i 200kb, scegli un file più piccolo");else{let ve=document.getElementById("imgSender");ve.style.display="flex";let oe=ve.getElementsByTagName("img")[0];oe.src="data:"+G.type+";base64,"+G.content,c=G}}};function _(){let y=document.getElementById("imgSender");y.style.display="none";let I=y.getElementsByTagName("img")[0];I.src="";let T=document.getElementById("allegatiDiv");T.style.display="none",Xt.set(c);let H=new Date;r={content:"data:"+c.type+";base64,"+c.content,ts:H.getHours()+":"+((H.getMinutes()<10?"0":"")+H.getMinutes()),from:"sender",dayWeek:s[H.getDay()]},console.log(r),l(4,m=[...m,r]);let U=document.getElementById("ChatContent");U&&setTimeout(()=>{U.scrollTop=U.scrollHeight},1)}const V=y=>h(y);function P(y){is[y?"unshift":"push"](()=>{C=y,l(2,C)})}const B=y=>{Bs()};function k(){u=this.value,l(1,u)}return[o,u,C,f,m,S,h,_,V,P,B,k,()=>{S("send")}]}class Ns extends je{constructor(t){super(),$e(this,t,Ms,Vs,we,{})}}const js={id:"",ver:"0.22.8",ua:"Just-smart",lang:"it-IT",platf:"web"},gt={hi:js},$s={id:"",scheme:"basic",secret:"YWxpY2U6YWxpY2UxMjM="},mt={login:$s},Ls={id:"",topic:"",get:{what:"sub desc tags cred"}},Ge={sub:Ls},Os={id:"",topic:"",get:{what:"sub desc"}},nt={sub:Os},qs={id:"",topic:"",what:"data"},de={get:qs},Hs={id:"",topic:"",noecho:!0,content:""},Qe={pub:Hs},Ps={id:"",topic:"fnd",what:"sub"},it={get:Ps},zs={id:"",topic:"fnd",desc:{public:""}},xe={set:zs},Js={id:"",topic:"fnd",get:{what:"sub"}},vt={sub:Js},As={id:"",topic:"",noecho:!0,head:{mime:"text/x-drafty"},content:{ent:[{tp:"EX",data:{mime:"",val:"",name:"a",size:0}}],fmt:[{at:-1}]}},qe={pub:As},Us={id:"",topic:"",noecho:!0,head:{mime:"text/x-drafty"},content:{ent:[{tp:"EX",data:{mime:"",ref:"",name:"a",size:0}}],fmt:[{at:-1}]}},Ws={attachments:[]},Te={pub:Us,extra:Ws};function Zs(i){xt(()=>{c.close()});let t="",l=[],e=!1,s,o="false",u=!1;as.subscribe(h=>{s=h,h!=""&&localStorage.setItem("secretKey",h),console.log("secretKey"+h)});let C="";s!=null&&(C=localStorage.getItem("secretKey"));var c=new WebSocket("ws://chat.justsmart.it/v0/channels?apikey=AQEAAAABAAD_rAp4DJh05a1HAwFT3A6K");let r="";c.onopen=function(h){console.log("[open] Connection established"),console.log("Sending to server"),r=Math.floor(Math.random()*(1e6-1e5)+1e5).toString(),gt.hi.id=r,console.log(JSON.stringify(gt)),c.readyState==1&&c.send(JSON.stringify(gt)),mt.login.id=r,console.log(C);let _=btoa(C);console.log(_),mt.login.secret=_.toString(),setTimeout(function(){c.send(JSON.stringify(mt))},500),Ge.sub.id=r,Ge.sub.topic="me",setTimeout(function(){c.send(JSON.stringify(Ge))},1e3),u=!0},c.onmessage=function(h){console.log(`[message] Data received from server: ${h.data}`);let _=JSON.parse(h.data);switch(Object.keys(_)[0]){case"ctrl":console.log("ctrl"),Object.keys(_.ctrl).includes("text")&&(_.ctrl.text=="delivered"?(bt.set(l),e=!0,l=[],os.set(_.ctrl.params.count),console.log(_.ctrl.params.count)):_.ctrl.text=="accepted"?(console.log("accepted"),l=[]):Object.keys(_.ctrl).includes("params")&&Object.keys(_.ctrl.params).includes("token")&&(console.log("count"),Rt.set(_.ctrl.params.token)));break;case"data":Object.keys(_.data.content).includes("ent")?(console.log("image"),S(_)):m(_);break;case"meta":Object.keys(_.meta).includes("sub")&&f(_.meta.sub),console.log("meta");break;case"pres":console.log("pres");break;case"info":console.log("info");break;default:console.log("default");break}};function f(h){console.log("listSubbed"+u),u&&(at.set([]),h.forEach(_=>{if(Object.keys(_).includes("public")){console.log(_.user);let V={name:_.public.fn==null?"undefined":_.public.fn,topic:o=="false"?_.topic:_.user,isSearch:o};at.update(P=>P.concat(V))}o="false"})),u=!1}et.subscribe(h=>{console.log("currentChatTopic resetted"),bt.set([]),e=!1,t=h,nt.sub.id=r,nt.sub.topic=h,console.log("SUBTOPIC"),console.log(JSON.stringify(nt)),de.get.id=r,de.get.topic=h,de.get.what="data",console.log("GET"),console.log(JSON.stringify(de)),c.readyState==1&&(c.send(JSON.stringify(nt)),setTimeout(()=>{c.send(JSON.stringify(de))},200))});function m(h){console.log("parseMessages"+h);let _=h.data.content,V=h.data.from,P=h.data.ts;h.data.dayWeek,P=P.replace("Z","-02:00"),P=P.toString();let B=new Date(P),k={from:V==t?"recepient":"sender",content:_,seq:h.data.seq,ts:B.getUTCHours()+":"+((B.getMinutes()<10?"0":"")+B.getMinutes())};l.push(k),e&&(dt.set(l),l=[])}function S(h){console.log("parseImage");let _=h.data.content.ent[0].data,V="data:"+_.mime+";base64,"+_.val,P=h.data.from,B=h.data.ts;h.data.dayWeek,B=B.replace("Z","-02:00"),B=B.toString();let k=new Date(B);console.log(t);let $={from:P==t?"recepient":"sender",content:V,seq:h.data.seq,ts:k.getUTCHours()+":"+((k.getMinutes()<10?"0":"")+k.getMinutes())};console.log($),l.push($),e&&(console.log("oldMsg"),dt.set(l),l=[])}return yt.subscribe(h=>{console.log("msgToSend"),console.log(h),Qe.pub.id=r,Qe.pub.topic=t,Qe.pub.content=h.content,console.log(JSON.stringify(Qe)),c.readyState==1&&c.send(JSON.stringify(Qe))}),Mt.subscribe(h=>{console.log("refresh"),c.readyState==1&&h==!0&&(Ge.sub.id=r,Ge.sub.topic="me",c.send(JSON.stringify(Ge)),Mt.set(!1))}),cs.subscribe(h=>{h!=""&&(o="true"),console.log("userSearch"),console.log(h),c.readyState==1&&(vt.sub.id=r,console.log(JSON.stringify(vt)),c.send(JSON.stringify(vt)),xe.set.id=r,xe.set.desc.public=h,it.get.id=r,setTimeout(function(){c.send(JSON.stringify(xe))},500),setTimeout(function(){c.send(JSON.stringify(it))},1e3))}),Yt.subscribe(h=>{console.log("addChat"),console.log(h),c.readyState==1&&(xe.set.id=r,xe.set.desc.public="␡",c.send(JSON.stringify(xe)),de.get.id=r,de.get.topic=h,de.get.what="desc",setTimeout(function(){c.send(JSON.stringify(de))},500),it.get.id=r,setTimeout(function(){c.send(JSON.stringify(it))},1e3),setTimeout(function(){at.set([]),de.get.what="sub",de.get.topic="me",c.send(JSON.stringify(de))},1500))}),Xt.subscribe(h=>{console.log("imgToSend"),console.log(h),qe.pub.id=r,qe.pub.topic=t,qe.pub.content.ent[0].data.mime=h.type,qe.pub.content.ent[0].data.val=h.content,qe.pub.content.ent[0].data.size=h.size,console.log(JSON.stringify(qe)),c.readyState==1&&(console.log("sending"),c.send(JSON.stringify(qe)))}),rs.subscribe(h=>{console.log("imgToSend"),console.log(h);let _=h;Te.pub.id=r,Te.pub.topic=t,Te.pub.content.ent[0].data.mime=_.type,Te.pub.content.ent[0].data.ref=_.url,Te.pub.content.ent[0].data.size=_.size,Te.extra.attachments[0]=h.url,console.log(JSON.stringify(Te)),c.readyState==1&&(console.log("sending"),c.send(JSON.stringify(Te)))}),[]}class Gs extends je{constructor(t){super(),$e(this,t,Zs,null,we,{})}}function Wt(i){let t,l;return t=new Es({}),{c(){Ve(t.$$.fragment)},l(e){Be(t.$$.fragment,e)},m(e,s){Me(t,e,s),l=!0},p:Ce,i(e){l||(J(t.$$.fragment,e),l=!0)},o(e){Z(t.$$.fragment,e),l=!1},d(e){Ne(t,e)}}}function xs(i){let t,l=i[0],e,s,o,u,C,c=Wt();return s=new Ns({}),u=new Gs({}),{c(){t=v("div"),c.c(),e=M(),Ve(s.$$.fragment),o=M(),Ve(u.$$.fragment),this.h()},l(r){t=p(r,"DIV",{id:!0,class:!0});var f=g(t);c.l(f),e=N(f),Be(s.$$.fragment,f),o=N(f),Be(u.$$.fragment,f),f.forEach(d),this.h()},h(){n(t,"id","mainContainer"),n(t,"class","svelte-sof1yo")},m(r,f){Y(r,t,f),c.m(t,null),a(t,e),Me(s,t,null),a(t,o),Me(u,t,null),C=!0},p(r,[f]){f&1&&we(l,l=r[0])?(Pe(),Z(c,1,1,Ce),ze(),c=Wt(),c.c(),J(c,1),c.m(t,e)):c.p(r,f)},i(r){C||(J(c),J(s.$$.fragment,r),J(u.$$.fragment,r),C=!0)},o(r){Z(c),Z(s.$$.fragment,r),Z(u.$$.fragment,r),C=!1},d(r){r&&d(t),c.d(r),Ne(s),Ne(u)}}}function Fs(i,t,l){Nt.subscribe(o=>{o&&s(),Nt.set(!1)});let e={};function s(){l(0,e={})}return xt(()=>{console.log("destroyed"),Fe.set(""),et.set("")}),[e]}class Ks extends je{constructor(t){super(),$e(this,t,Fs,xs,we,{})}}function Ys(i){let t,l;return t=new Ks({}),{c(){Ve(t.$$.fragment)},l(e){Be(t.$$.fragment,e)},m(e,s){Me(t,e,s),l=!0},p:Ce,i(e){l||(J(t.$$.fragment,e),l=!0)},o(e){Z(t.$$.fragment,e),l=!1},d(e){Ne(t,e)}}}class sl extends je{constructor(t){super(),$e(this,t,null,Ys,we,{})}}export{sl as default};
